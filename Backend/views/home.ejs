<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Cryptocurrency Prices</title>
		<script src="https://cdn.tailwindcss.com"></script>
	</head>
	<body class="bg-gray-100 min-h-screen flex flex-col">
		<!-- Header -->
		<header class="w-full fixed top-0 bg-blue-600 text-white shadow-md z-50">
			<div class="container mx-auto"><%- include('./partials/nav') %></div>
		</header>

		<!-- Main Content -->
		<main class="mt-20 w-full max-w-4xl mx-auto">
			<div class="bg-white shadow-md rounded-lg overflow-hidden">
				<table class="table-auto w-full border-collapse">
					<thead class="bg-blue-600 text-white">
						<tr>
							<th class="px-4 py-2 text-left">#</th>
							<th class="px-4 py-2 text-left">Image</th>
							<th class="px-4 py-2 text-left">Name</th>
							<th class="px-4 py-2 text-left">Symbol</th>
							<th class="px-4 py-2 text-right">Current Price (USD)</th>
						</tr>
					</thead>
					<tbody id="crypto-table">
						<!-- Dynamic rows will be inserted here -->
					</tbody>
				</table>
			</div>
		</main>

		<!-- Footer -->
		<footer class="mt-8 py-4 bg-gray-800 text-white text-center w-full">
			<p>Â© 2025 Crypto Monitor. All Rights Reserved.</p>
		</footer>

		<!-- WebSocket Script -->
		<script src="/socket.io/socket.io.js"></script>
		<script>
			const socket = io("http://localhost:8000");

			socket.on("cryptoPrices", (data) => {
				const tableBody = document.getElementById("crypto-table");
				tableBody.innerHTML = ""; // Clear old data

				data.forEach((coin, index) => {
					const row = document.createElement("tr");
					row.innerHTML = `
            <td class="border px-4 py-2">${index + 1}</td>
            <td class="border px-4 py-2"><img src="${coin.image}" alt="${
						coin.name
					}" class="w-8 h-8"></td>
            <td class="border px-4 py-2">${coin.name}</td>
            <td class="border px-4 py-2">${coin.symbol.toUpperCase()}</td>
            <td class="border px-4 py-2 text-right">$${coin.current_price.toFixed(
							2
						)}</td>
          `;
					tableBody.appendChild(row);
				});
			});
		</script>
	</body>
</html>
